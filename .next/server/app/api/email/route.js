"use strict";(()=>{var e={};e.id=433,e.ids=[433],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4163:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>h,patchFetch:()=>g,requestAsyncStorage:()=>d,routeModule:()=>p,serverHooks:()=>y,staticGenerationAsyncStorage:()=>m});var n={};s.r(n),s.d(n,{GET:()=>l,POST:()=>u});var r=s(9303),o=s(8716),i=s(670),a=s(3493),c=s(7070);async function u(e){try{let{userId:t,query:s,responses:n}=await e.json();if(!t||!s)return c.NextResponse.json({error:"Missing required fields"},{status:400});try{let e=await a.PJ.createTribunalSession(t,s,n);return c.NextResponse.json({success:!0,message:"GestaltView Waitlist API",sessionId:e?.id||"test-session"})}catch(e){return console.error("Database error:",e),c.NextResponse.json({success:!0,message:"Revolutionary consciousness captured! We'll be in touch soon.",fallback:!0})}}catch(e){return console.error("Email API error:",e),c.NextResponse.json({success:!1,error:"Revolutionary consciousness synthesis temporarily paused",keith_message:"Your experience is still valid. Every difficult chapter became a feature! \uD83D\uDE80"},{status:500})}}async function l(){return c.NextResponse.json({message:"Keith's Revolutionary Email API - Consciousness serving technology",status:"operational",wisdom:"ADHD is my jazz - not noise, but a different frequency of genius"})}let p=new r.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/email/route",pathname:"/api/email",filename:"route",bundlePath:"app/api/email/route"},resolvedPagePath:"/workspaces/RogueFox/app/api/email/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:d,staticGenerationAsyncStorage:m,serverHooks:y}=p,h="/api/email/route";function g(){return(0,i.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:m})}},3493:(e,t,s)=>{s.d(t,{PJ:()=>o});let n=require("@prisma/client"),r=globalThis.prisma??new n.PrismaClient({log:["error"],datasources:{db:{url:process.env.POSTGRES_PRISMA_URL}}}),o={getUserWithProfile:async e=>r.user.findUnique({where:{clerkId:e},include:{consciousnessProfile:!0,bucketDrops:{orderBy:{capturedAt:"desc"},take:10},tribunalSessions:{orderBy:{createdAt:"desc"},take:5},musicalDnaAnalyses:{orderBy:{createdAt:"desc"},take:1}}}),createUserIfNotExists:async(e,t)=>r.user.upsert({where:{clerkId:e},update:{},create:{clerkId:e,email:t,consciousnessProfile:{create:{plkVersion:"5.0.0_Ultimate",empowermentLevel:50,consciousnessGrade:"developing"}}},include:{consciousnessProfile:!0}}),createBucketDrop:async(e,t,s={})=>r.bucketDrop.create({data:{userId:e,content:t,emotionalIntensity:s.emotionalIntensity||.5,urgencyLevel:s.urgencyLevel||3,hyperfocusIndicator:s.hyperfocus||!1,executiveFunctionTag:s.executiveFunction,plkResonance:s.plkResonance||0,metaphorExtracted:s.metaphor,...s}}),getUserBucketDrops:async(e,t=20)=>r.bucketDrop.findMany({where:{userId:e},orderBy:{capturedAt:"desc"},take:t}),createTribunalSession:async(e,t,s)=>r.tribunalSession.create({data:{userId:e,queryText:t,sessionType:s.sessionType||"full_tribunal",openaiResponse:s.openai||s.architect||s.revolutionary,anthropicResponse:s.claude||s.mirror||s.weaver,geminiResponse:s.gemini||s.philosopher||s.oracle,perplexityResponse:s.perplexity||s.witness||s.scout,consensusScore:s.consensus?.score||0,empowermentConsensus:s.consensus?.empowerment||0,consciousnessInsights:s.insights||{},keithWisdomTriggered:s.keithWisdom||!1,foundationalTruthHit:s.foundationalTruth||!1,revolutionaryPotential:s.revolutionaryPotential||.5,personasUsed:s.personasUsed||[],completedAt:new Date}}),getUserTribunalSessions:async(e,t=10)=>r.tribunalSession.findMany({where:{userId:e},orderBy:{createdAt:"desc"},take:t}),updateMusicalDNA:async(e,t)=>r.musicalDnaAnalysis.upsert({where:{userId:e},update:{primaryGenres:t.genres||[],primaryArtists:t.artists||[],emotionalThemes:t.themes||{},acousticPreference:t.acoustic||.5,introspectionLevel:t.introspection||.5,resilienceMarkers:t.resilience||.5,connectionLonging:t.connection||.5,catharticProcessing:t.catharsis||.5,narrativeArc:t.narrative,transformationStage:t.stage,musicalMetaphors:t.metaphors||{},songsAnalyzed:t.songCount||0,confidenceLevel:t.confidence||0,updatedAt:new Date},create:{userId:e,primaryGenres:t.genres||[],primaryArtists:t.artists||[],emotionalThemes:t.themes||{},acousticPreference:t.acoustic||.5,introspectionLevel:t.introspection||.5,resilienceMarkers:t.resilience||.5,connectionLonging:t.connection||.5,catharticProcessing:t.catharsis||.5,narrativeArc:t.narrative,transformationStage:t.stage,musicalMetaphors:t.metaphors||{},songsAnalyzed:t.songCount||0,confidenceLevel:t.confidence||0}}),trackConsciousnessMetric:async(e,t)=>r.consciousnessMetric.create({data:{userId:e,attentionLevel:t.attention||50,flowStateIndicator:t.flow||.5,executiveFunctionLoad:t.executiveLoad||.5,hyperfocusActive:t.hyperfocus||!1,empowermentMomentum:t.empowerment||.5,authenticityAlignment:t.authenticity||.5,consciousnessClarity:t.clarity||.5,revolutionaryReadiness:t.revolutionary||0,environmentalFactors:t.environment||{},socialContext:t.social||{},timeOfDay:t.timeOfDay,energyLevel:t.energy||50,supportNeeded:t.support||!1,interventionType:t.intervention}}),createEmpowermentEvent:async(e,t,s)=>r.empowermentEvent.create({data:{userId:e,eventType:t.type||"breakthrough",description:t.description,intensityLevel:t.intensity||.5,scarsToCodeMoment:t.scarsToCode||!1,chaosCurrentRealized:t.chaosCurrentRealized||!1,jazzFrequencyTuned:t.jazzFrequencyTuned||!1,sourceType:t.source||"tribunal",bucketDropId:s,consciousnessShift:t.shift||0,empowermentIncrease:t.increase||0,revolutionaryPotential:t.revolutionary||0,aiValidated:t.aiValidated||!1,userConfirmed:t.confirmed||!1}}),createTapestryNode:async(e,t,s,n={})=>r.tapestryNode.create({data:{userId:e,thoughtContent:t,emotionalResonance:n.emotional||.5,consciousnessDepth:n.depth||1,growthSignificance:n.growth||0,xCoordinate:n.x,yCoordinate:n.y,zCoordinate:n.z||0,nodeSize:n.size||20,nodeColor:n.color||"#8B5CF6",connectedNodes:n.connections||[],connectionStrengths:n.strengths||[],aiInterpretation:n.ai||{},patternCategory:n.category,empowermentPotential:n.potential||.5,bucketDropId:s}})}},9303:(e,t,s)=>{e.exports=s(517)}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),n=t.X(0,[510],()=>s(4163));module.exports=n})();